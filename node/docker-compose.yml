networks:
  carmentis-network:
    driver: bridge
services:
  node-abci:
    container_name: ${ENV_TAG}-node-abci
    image: ghcr.io/carmentis/node/abci:${ENV_TAG}
    ports:
    - '26658'
    - 26659:26659
    volumes:
    - ${NODE_COMETBFT_CONFIG}:/cometbft
    - ./config.toml:/app/config.toml
  node-cometbft:
    command:
    - start
    - --abci
    - grpc
    - --proxy_app
    - node-abci:26658
    - --rpc.laddr
    - tcp://0.0.0.0:26657
    container_name: ${ENV_TAG}-node-combetft
    depends_on:
    - node-abci
    image: cometbft/cometbft:v1.x
    ports:
    - 26656:26656
    - 26657:26657
    - 26658:26658
    user: ${UID}:${GID}
    volumes:
    - ${NODE_COMETBFT_CONFIG}:/cometbft
version: '3.3'
